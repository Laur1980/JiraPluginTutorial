AJS.test.require("jira.webresources:navigation-utils",function(){require(["jira/util/navigation","backbone"],function(a,e){module("NavigationUtils",{setup:function(){a.pushStateSupported=!0}}),test("should return value of parameter",function(){equal(a.getParam("param1",!1,"?param1=test&param2=45"),"test"),equal(a.getParam("param2",!1,"?param1=test&param2=45"),"45")}),test("should return undefined if there is no parameter",function(){var e="";strictEqual(a.getParam("param1",!1,e),void 0),e="../../../",strictEqual(a.getParam("param2",!1,e),void 0)}),test("should return parameter value from hash if told to do so",function(){var e="?param1=test&param2=34&param3=asd#param2=45";equal(a.getParam("param1",!0,e),"test"),equal(a.getParam("param2",!1,e),"34"),equal(a.getParam("param2",!0,e),"45")}),test("should return last value of parameter",function(){var e="?param1=value1&param1=value2#param1=hash";equal(a.getParam("param1",!1,e),"value2"),equal(a.getParam("param1",!0,e),"hash")}),test("should decode encoded params",function(){var e="?param=%3Cvalue%3E&param2=some%20text&param3=%3Csome%20value%3E";equal(a.getParam("param",!1,e),"<value>","Should URI-decode the value."),equal(a.getParam("param2",!1,e),"some text","Should change + to spaces."),equal(a.getParam("param3",!1,e),"<some value>","Should URI-decode the value and change + to space.")}),test("should build proper query from passed parameters",function(){var e={param1:"value1",param2:45,param3:!1};equal(a.buildQuery(e),"?param1=value1&param2=45")}),test("should encode parameters in built query",function(){var e={param1:'"<test param>"',param2:"param3=value3&param4=value"};console.log(a.buildQuery(e)),equal(a.buildQuery(e),"?param1=%22%3Ctest+param%3E%22&param2=param3%3Dvalue3%26param4%3Dvalue")}),test("should build proper query depending on push state support",function(){var e={param1:"value1",param2:"value2"};equal(a.buildQuery(e),"?param1=value1&param2=value2"),a.pushStateSupported=!1,equal(a.buildQuery(e),"param1=value1&param2=value2")}),test("should navigate to proper urls based on push state support",function(){e.history.navigate=sinon.spy();var r="?param1=value1&param2=value2#param3";a.navigate(r),ok(e.history.navigate.calledWith(window.location.pathname+r)),a.pushStateSupported=!1,a.navigate(r),ok(e.history.navigate.calledWith(r))}),test("should build query from parameters if object is passed",function(){e.history.navigate=sinon.spy();var r={param1:"value1",param2:"value2",param3:!1};a.navigate(r),ok(e.history.navigate.calledWith(window.location.pathname+"?param1=value1&param2=value2"))})})});