define("jira/project/project-edit-key",["jira/analytics","jira/util/key-code","jira/util/formatter","jira/lib/class","jquery","aui/flag","underscore","aui/inline-dialog2"],function(e,i,t,n,a,l,r){return n.extend({init:function(e,i){this.options=r.defaults(i||{},{flagShowDelay:600});var t=a(e),n=this;this.warningFlag=null,this.$input=t.find("#project-edit-key"),this.$initialKey=t.find("#edit-project-original-key"),this.$keyEdited=t.find("#edit-project-key-edited"),this.updateFlagDebounced=r.throttle(this.updateFlag,this.options.flagShowDelay,{leading:!1,trailing:!0}),this.updateFlag(),t.find("#project-edit-key").on("remove",function(){n.cleanupFlag()})},checkModified:function(){this.updateFlagDebounced(),this.$keyEdited.val(this._hasBeenModified().toString())},updateFlag:function(){this._hasBeenModified()?null==this.warningFlag&&this.createFlag():this.cleanupFlag()},cleanupFlag:function(){null!=this.warningFlag&&(this.warningFlag.close(),this.warningFlag=null)},createFlag:function(){this.warningFlag=l({type:"warning",title:"",body:JIRA.Templates.Project.ChangeTriggeredFlag.fieldRevertWarning({message:t.I18n.getText("admin.projects.edit.project.key.warning.message"),revertMessage:t.I18n.getText("admin.projects.edit.project.warning.cancel")})});var e=this;a(this.warningFlag).find(".cancel").click(function(i){i.preventDefault(),e._revert()}),a(this.warningFlag).find(".icon-close").click(function(){e.updateFlagDebounced=function(){},e.warningFlag=null}),a(this.warningFlag).find(".icon-close").keypress(function(t){t.which!==i.ENTER&&t.which!==i.SPACE||(e.updateFlagDebounced=function(){},e.warningFlag=null)})},_hasBeenModified:function(){return this.$initialKey.val()!==this.$input.val()},_revert:function(){this.$input.val(this.$initialKey.val()),this.updateFlag(),e.send({name:"jira.administration.projectdetails.projectkeyupdate.cancelled"})}})}),AJS.namespace("ProjectEditKey",null,require("jira/project/project-edit-key"));