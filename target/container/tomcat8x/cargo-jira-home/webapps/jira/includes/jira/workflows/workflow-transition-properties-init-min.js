require(["jquery","underscore","aui/restful-table","wrm/context-path","jira/util/formatter","jira/ajs/ajax/ajax-util","jira/ajs/ajax/smart-ajax","jira/dialog/error-dialog","jira/workflows/workflow-transition-properties"],function(e,t,r,o,a,i,l,n,s){"use strict";e(function(){var w=o()+"/rest/api/2/workflow/transitions/",d=e("#workflow-transition-properties-table"),u=d.attr("data-workflowTransition"),f=encodeURIComponent(d.attr("data-workflowName")),p=encodeURIComponent(d.attr("data-workflowMode")),c=d.attr("data-key-header"),k=d.attr("data-value-header"),y="true"===d.attr("data-workflow-editable"),m=function(r){return t.isString(r)?e.trim(r):r},h=r.EntryModel.extend({initialize:function(){this.url=function(){var e=this.get("key")||"";return w+u+"/properties?workflowName="+f+"&workflowMode="+p+"&key="+e},r.EntryModel.prototype.initialize.apply(this,arguments)},destroy:function(e){e=t.extend({},e,{data:{}}),r.EntryModel.prototype.destroy.call(this,e)},changedAttributes:function(e){var r={};return t.each(e,function(e,t){e=m(e),this.get(t)!==e&&(r[t]=e)},this),!t.isEmpty(r)&&r},defaults:{value:""}});new r({autoFocus:!0,el:d,resources:{all:w+u+"/properties?workflowName="+f+"&workflowMode="+p,self:w+u+"/properties?workflowName="+f+"&workflowMode="+p},columns:[{id:"key",header:c,styleClass:"workflow-transition-properties-key-col",readView:s.KeyView,createView:s.CreateKeyView,editView:s.EditKeyView,allowEdit:!1},{id:"value",header:k,styleClass:"workflow-transition-properties-value-col",readView:s.ValueView}],model:h,allowEdit:y,allowCreate:y,allowDelete:y,reverseOrder:!0,noEntriesMsg:a.I18n.getText("admin.workflowtransition.no.entries.set")}),e(document).ajaxError(function(e,t,r){400!==t.status&&r.url.indexOf(w)>=0&&(i.isWebSudoFailure(t)?l.handleWebSudoError(r):n.openErrorDialogForXHR(t))})})});