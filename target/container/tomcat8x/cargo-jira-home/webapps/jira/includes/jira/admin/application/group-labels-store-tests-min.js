AJS.test.require(["jira.webresources:application-role-labels"],function(){require(["underscore","jquery"],function(e,t){function s(e,t){return{name:e,labels:t}}var r;module("GroupLabelsStore tests",{setup:function(){this.context=AJS.test.mockableModuleContext(),this.sandbox=sinon.sandbox.create(),this.server=sinon.fakeServer.create(),this.clock=sinon.useFakeTimers(),r=this.context.require("jira/admin/application/group-labels-store")},teardown:function(){this.sandbox.restore(),this.server.restore(),this.clock.restore()}}),test("consecutive requests terminate ongoing requests",function(e){r.fetchLabels(),this.clock.tick(200),r.fetchLabels(),e.ok(this.server.requests[0].aborted,"GET aborted")}),test("it will trigger listener",function(e){var t=this.sandbox.stub(r,"fetchLabels"),n=this.sandbox.stub(),o=this.sandbox.stub(),i=r.syncLabels("group1","role1",n),a=r.syncLabels("group2","role2",o);r.triggerListener(i,[s("group1")]),r.triggerListener(a,[s("group1")]),r.triggerListener(i,[s("group2")]),sinon.assert.calledOnce(n),sinon.assert.notCalled(o),sinon.assert.calledTwice(t)}),test("callback not fired after removing handler",function(e){var t=this.sandbox.stub(r,"fetchLabels"),n=this.sandbox.stub();r.syncLabels("group1","role1",n),r.triggerListeners([s("group1")]),r.removeHandler(n),r.triggerListeners([s("group1")]),sinon.assert.calledOnce(n,"callback1 not triggered second time"),sinon.assert.calledOnce(t,"callback1 not triggered second time")})})});