var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("jira/admin/analytics",["jira/project/projectdata","jira/util/events","jira/admin/admindata","jira/common/page","wrm/context-path","jira/util/data/meta","jquery","jira/analytics","jira/libs/parse-uri"],function(e,t,o,i,n,c,r,a,f){function s(e,t,o){return o="object"!==(void 0===o?"undefined":_typeof(o))?{}:o,t=t||"unknown",{name:"administration."+e+"."+t,properties:r.extend({type:t,tab:c.get("admin.active.tab"),section:c.get("admin.active.section")},o)}}function d(e,t){a.send(s("projectconfig.workflowscheme",e,t))}function l(e,t){a.send(s("workflowscheme",e,t))}function u(){return!!r(".status-draft").length}function w(e,t){return s("workflow",e,t)}function p(e,t){a.send(s("navigate",e,t))}function k(e,t){a.send(s("projectconfig.workflow",e,t))}function m(e,t){S.on("click",e,function(){var e=r(this).data("mode");a.send(w("selectmode",{mode:e,edit:t}))})}function g(e,t,o){a.send(w("edit",{mode:e,action:t,object:o}))}function j(){k("loadworkflowstab",{referrer:y(document.referrer)})}function h(e,t,o){S.on("click",e,function(){g("text",t,o)})}function v(e,t){"true"!==r(t.currentTarget).attr("aria-pressed")&&a.send({name:"projectconfig.toggle."+e})}function y(e){if("string"!=typeof e)return null;var t,o=f(e),i=c.get("projectKey");return t=o.path.slice(n().length),t=t.replace(/project-config\/(.*?)(\/|$)/,"project-config/PROJECTKEY$2"),i&&i.length&&(t=t.split(i).join("PROJECTKEY")),t}function b(){t.bind("addworkflow",function(){u()&&l("addworkflowtodraft")}),t.bind("assignissuetypes",function(){u()&&l("assignissuetypestodraft")}),S.on("click",".remove-all-issue-types",function(){u()&&l("deleteworkflowfromdraft")}),S.on("click","#discard-draft-dialog input[type=submit]",function(){x?d("discarddraft"):l("discarddraft")}),S.on("click","#view-original",function(){l("vieworiginalofdraft")}),S.on("click","#view-draft",function(){l("viewdraft")}),S.on("click","#publish-draft",function(){l("publishclicked")}),x||"draftMigrationSuccess"!==f(location).anchor||l("migrationcompleted"),t.bind("draftcreated",function(){x?d("draftcreated"):l("draftcreated")}),S.on("click","#workflowscheme-editor .workflow-text-view",function(){l("viewworkflow",{mode:"text"})}),S.on("click","#workflowscheme-editor .workflow-diagram-view",function(){l("viewworkflow",{mode:"diagram"})}),S.on("click","#project-config-panel-fields .project-config-icon-edit",function(){a.send({name:"administration.fields.edit.link.clicked.project"})}),S.on("click","#project-config-issuetype-scheme-edit",function(){a.send({name:"administration.issuetypeschemes.edit.link.clicked.project"})}),S.on("click","#project-config-issuetype-scheme-change",function(){a.send({name:"administration.issuetypeschemes.switch.link.clicked.project"})}),S.on("click","#project-config-panel-screens a.project-config-screen",function(){var e=r(this).data("operationId");1===e?a.send({name:"administration.screenschemes.editlink.clicked.operation.edit"}):2===e?a.send({name:"administration.screenschemes.editlink.clicked.operation.view"}):a.send({name:"administration.screenschemes.editlink.clicked.operation.create"})}),S.on("click",".project-config-more-link",function(){var e=r(this);p("morelink",{href:y(e.attr("href")),title:e.attr("title")})}),i.relatedContentElement().on("click","a",function(){var t=r(this),i=t.attr("id");i=/^view_project_issuetype_\d+$/.test(i)?"view_project_issuetype":i,p("tabs",{id:i,href:y(t.attr("href")),title:t.text(),isAdmin:o.isUserAdmin(),isSysAdmin:o.isUserSysAdmin(),projectType:e.getProjectType()})}),S.on("click","#project-config-header-name",function(){p("projectheader")}),S.on("click","#project-config-header-avatar",function(){p("projectavatar")}),S.on("click",".back-to-proj-config",function(){p("backtoproject",{href:y(r(this).attr("href"))})}),S.on("click",".project-config-summary-scheme a",function(){p("selectedscheme",{href:y(r(this).attr("href"))})}),S.on("click",".project-config-workflow-text-link",function(){k("viewastext")}),S.on("click",".project-config-screen",function(){k("gotoscreen")}),S.on("click",".project-config-workflow-edit",function(){k(r(this).closest(".project-config-workflow-default").length?"copyworkflow":"editworkflow")}),S.on("click",".issuetypeconfig-edit-workflow",function(){k("editworkflowissuetype")}),S.on("click","#toggleWorkflowTab",function(e){v("workflow",e)}),S.on("click","#toggleViewTab",function(e){v("view",e)}),S.on("click",".project-config-workflow-diagram-container",function(){k("enlargeworkflow")}),S.on("click","#project-config-workflows-view-original",function(){d("vieworiginalofdraft")}),S.on("click","#project-config-workflows-view-draft",function(){d("viewdraft")}),S.on("click","#project-config-workflows-scheme-change",function(){d("switchscheme")}),S.on("click","#project_import_link_lnk",function(){p("topnav.jim")}),m(".workflow-view-toggle",!1),m(".workflow-edit-toggle",!0),h("#workflow-step-add-submit","add","step"),h("#workflow-step-update","update","step"),h("#workflow-step-delete","remove","step"),h("#workflow-transition-add","add","transition"),h("#workflow-transition-update","update","transition"),h("#workflow-transition-delete","remove","transition"),h("#workflow-global-transition-update","update","globaltransition"),t.bind("wfd-edit-action",function(e,t){g("diagram",t.action,t.object)})}var S=r(document),_=c.get("admin.active.section"),x="atl.jira.proj.config"===_;return{bindEvents:b,event:s,sendProjectWorkflowSchemeEvent:d,sendLoadWorkflowsTabEvent:j}}),AJS.namespace("JIRA.Analytics",null,require("jira/admin/analytics"));