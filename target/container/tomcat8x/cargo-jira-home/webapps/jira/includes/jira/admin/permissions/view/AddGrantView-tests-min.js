AJS.test.require("jira.webresources:projectpermissions",function(){function e(e,i,r,t,n){return new u({securityType:e,displayName:i,primary:r,values:t,help:n})}function i(i,r){return e("user","User",!1,i,r)}function r(){return i([],null)}function t(){return i([],{infoText:"No permission",helpText:"More help",helpUrl:"url"})}function n(e){return new o({model:new u({securityType:e,displayName:"Test1",primary:!1,values:[{value:"val1",displayValue:"dispVal1"},{value:"val2",displayValue:"dispVal2"}]})})}var s=require("jquery"),l=require("underscore"),o=require("jira/project/permissions/addgrantview"),u=require("jira/project/permissions/grantmodel"),a=require("jira/project/permissions/securitytypes");module("projectpermissions/add-grant-view"),test("A user with no browse user permission shows info icon",function(){var e=new o({model:t()});e.render(),ok(e.$el.find(".aui-icon.icon-help").length>0)}),test("A user with browse user permission does not show info icon ",function(){var e=new o({model:r()});e.render(),ok(0===e.$el.find(".aui-icon.icon-help").length)}),test("Selecting radio button toggles display of any textboxes",function(){var e=new o({model:r()});e.render(),s("#qunit-fixture").append(e.$el),ok(!e.$el.find("#user-single-select").is(":visible"),"Input view should not be visible"),e.$el.find(".security-type-item-radio-btn").click(),ok(e.$el.find("#user-single-select").is(":visible"),"After radio click, input view should be visible")}),test("Test event was added and initial value is stored in the model",function(){var e=[a.USER_CF,a.GROUP_CF,a.PROJECT_ROLE,a.APPLICATION_ROLE,a.GROUP,a.SINGLE_USER];l.each(e,function(e){var i=n(e),r=i.renderInput();if(ok(r,"Expected render input for "+e),ok(r.model.$element.data("events").selected),a.SINGLE_USER==e)strictEqual(i.model.get("securityTypeParamVal"),null,"No value set for single user there is no default");else{strictEqual(i.model.get("securityTypeParamVal").length,1,"Expecting only the first value");var t=i.model.get("securityTypeParamVal")[0];a.APPLICATION_ROLE==e?strictEqual(t,"","Expected empty string representing Any logged in user"):a.GROUP==e?strictEqual(t,"","Expected empty string representing Anyone"):strictEqual(t,"val1","Expecting the first value")}})})});