define("jira/field/issue-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","wrm/context-path","jquery","jira/libs/parse-uri"],function(e,s,i,t,r,n){var a=t(),u=e.extend({_formatResponse:function(e){var t=[],u=function(){var e=n(window.location);return e.protocol+"://"+e.authority}();return e&&e.sections&&r(e.sections).each(function(e,n){var o=new s({weight:e,label:n.label,description:n.sub});n.issues&&n.issues.length>0&&r(n.issues).each(function(){o.addItem(new i({highlighted:!0,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?u+a+this.img:null,html:this.keyHtml+" - "+this.summary}))}),t.push(o)}),t},_getDefaultOptions:function(){return r.extend(!0,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function e(e,s){return null==e?s:e}var s,i,t,n,o=this;u.callback=function(e){"string"==typeof e&&(e=JSON.parse(e)),o._addMultipleItems(e,!0),o.$field.focus()},n=this.options.ajaxOptions.data,s=a+"/secure/popups/IssuePicker.jspa?",i={singleSelectOnly:"false",decorator:"popup",currentIssue:n.currentIssueKey||"",showSubTasks:e(n.showSubTasks,!1),showSubTasksParent:e(n.showSubTaskParent,!1)},n.currentProjectId&&(i.currentProjectId=n.currentProjectId),s+=r.param(i),t=window.open(s,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable"),t.opener=self,t.focus()},_createFurniture:function(e){var s;this._super(e),s=this._render("popupLink"),this._assignEvents("popupLink",s),this.$container.addClass("jira-issue-picker"),this.$container.addClass("hasIcon"),this.$container.after(s)},handleFreeInput:function(){var e=this.$field.val().toUpperCase().match(/\S+/g);e&&this._addMultipleItems(r.map(e,function(e){return{value:e,label:e}})),this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup(),e.preventDefault()}}},_renders:{popupLink:function(){return r("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage)}}});return u.callback=null,u}),AJS.namespace("jira.issuepicker",null,require("jira/field/issue-picker")),AJS.namespace("AJS.IssuePicker",null,require("jira/field/issue-picker")),AJS.namespace("JIRA.IssuePicker",null,require("jira/field/issue-picker"));