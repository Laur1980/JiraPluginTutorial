define("jira/license-banner",["jira/util/logger","jira/analytics","jquery","underscore","jira/flag","aui/banner","wrm/context-path"],function(n,e,a,i,t,c,r){"use strict";function o(e){if(e&&e.length){var c=t.showWarningMsg(null,e);if(c){var r=a(c),o=i.once(p("flag",r));r.on("aui-flag-close",o),a("#license-flag-later").click(function(n){n.preventDefault(),r[0].close(),o()}),d("show","flag",r),g("flag",r)}}n.trace("license-flag-checked")}function l(e){if(e&&e.length){var t=a(c({body:e})),r=i.once(p("banner",t));a("#license-banner-later").click(function(n){n.preventDefault(),u(t),r()}),d("show","banner",t),g("banner",t)}n.trace("license-banner-checked")}var s=r(),f=function(e,i){return a.ajax({type:"POST",url:s+"/rest/internal/1.0/licensebanner/"+e,contentType:"application/json"}).always(function(){n.trace(i)})},u=function(n){n.slideUp(function(){n.remove()})},d=function(n,a,t){var c=t.find("div[data-days]").attr("data-days"),r="false"===t.find("[data-subscription]").attr("data-subscription")?"maintenance":"subscription",o="jira.expiry-notification."+r+"."+a+"."+n;e.send({name:o,data:i.omit({days_pre_expiry:c},i.isEmpty)})},p=function(n,e){return function(){f("remindlater","license-later-done"),d("close",n,e)}},g=function(n,e){e.find("[data-action]").on("click",function(){d("click."+a(this).attr("data-action"),n,e)})};return{showLicenseFlag:o,showLicenseBanner:l}});