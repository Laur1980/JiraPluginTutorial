var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};define("jira/ajs/keyboardshortcut/keyboard-shortcut",["jira/util/formatter","jira/util/key-code","aui/inline-dialog","wrm/context-path","jquery","underscore"],function(t,e,o,n,r,i){var c=n(),u=function(t,e){this._executer=null,this.shortcuts=[t],this._bindShortcut(t,e)};return u.prototype._bindShortcut=function(t,e){if("string"!=typeof t)throw new TypeError("KeyboardShortcut expects string; received "+(void 0===t?"undefined":_typeof(t)));if(/^(?:ctrl|alt|shift|meta)+/i.test(t))throw new SyntaxError('KeyboardShortcut cannot bind the shortcut "'+t+'" because it uses a modifier');var n=this;r(document).bind("shortcut",t,function(r){n._executer&&!n._ignoreShortcut(r,t,e)&&(o.current&&o.current.hide(),n._executer(r),r.preventDefault())})},u.prototype._ignoreShortcut=function(t,e,o){var n=!1;return i.each(u._ignoreConditions,function(r){r(t,e,o)&&(n=!0)}),n},u.prototype._addShortcutTitle=function(e){var o=r(e),n=o.attr("title")||"",i=t.I18n.getText("keyboard.shortcuts.type"),c=t.I18n.getText("keyboard.shortcuts.then"),u=t.I18n.getText("keyboard.shortcuts.or");n+=" ( "+i+r.map(this.shortcuts,function(t){return" '"+t.split("").join("' "+c+" '")+"'"}).join(" "+u+" ")+" )",o.attr("title",n)},u.prototype.moveToNextItem=function(t){this._executer=function(){var o,n=r(t),i=r(t+".focused");this._executer.blurHandler||r(document).one("keypress",function(t){t.keyCode===e.ESCAPE&&i&&i.removeClass("focused")}),0===i.length?i=r(t).eq(0):(i.removeClass("focused"),o=r.inArray(i.get(0),n),o<n.length-1?(o+=1,i=n.eq(o)):(i.removeClass("focused"),i=r(t).eq(0))),i&&i.length>0&&(i.addClass("focused"),i.scrollIntoView(),i.find("a:first").focus())}},u.prototype.moveToPrevItem=function(t){this._executer=function(){var o,n=r(t),i=r(t+".focused");this._executer.blurHandler||r(document).one("keypress",function(t){t.keyCode===e.ESCAPE&&i&&i.removeClass("focused")}),0===i.length?i=r(t+":last"):(i.removeClass("focused"),o=r.inArray(i.get(0),n),o>0?(o-=1,i=n.eq(o)):(i.removeClass("focused"),i=r(t+":last"))),i&&i.length>0&&(i.addClass("focused"),i.scrollIntoView(),i.find("a:first").focus())}},u.prototype.click=function(t){this._addShortcutTitle(t),this._executer=function(){var e=r(t).eq(0);e.length>0&&e.click()}},u.prototype.goTo=function(t){this._executer=function(){window.location.href=c+t}},u.prototype.followLink=function(t){this._addShortcutTitle(t),this._executer=function(){var e=r(t).eq(0);e.length>0&&("a"===e.prop("nodeName").toLowerCase()||"link"===e.prop("nodeName").toLowerCase())&&(e.click(),window.location.href=e.attr("href"))}},u.prototype.moveToAndClick=function(t){this._addShortcutTitle(t),this._executer=function(){var e=r(t).eq(0);e.length>0&&(e.click(),e.scrollIntoView())}},u.prototype.moveToAndFocus=function(t){this._addShortcutTitle(t),this._executer=function(e){var o=r(t).eq(0);o.length>0&&(o.focus(),o.scrollIntoView(),o.is(":input")&&e.preventDefault())}},u.prototype.evaluate=function(t){"function"!=typeof t&&(t=new Function(t)),t.call(this)},u.prototype.execute=function(t){var e=this;this._executer=function(){"function"!=typeof t&&(t=new Function(t)),t.call(e)}},u.prototype.or=function(t){return this.shortcuts.push(t),this._bindShortcut(t),this},u._ignoreConditions=[],u._shortcuts=[],u.addIgnoreCondition=function(t){u._ignoreConditions.push(t)},u.getKeyboardShortcutKeys=function(t){for(var e in u._shortcuts){var o=u._shortcuts[e];if(o.moduleKey===t)return o.keys.toString()}return null},u.fromJSON=function(t){var e;return t&&(u._shortcuts=t,e={},i.each(t,function(t){var o=i.flatten(t.keys),n=o.join("");if(o.length<n.length)throw new Error("Shortcut sequence ["+o.join(",")+"] contains invalid keys");(e[n]=new u(n,t.context))[t.op](t.param)})),e},u}),AJS.namespace("AJS.KeyboardShortcut",null,require("jira/ajs/keyboardshortcut/keyboard-shortcut"));