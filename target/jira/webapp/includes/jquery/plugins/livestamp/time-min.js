define("jira/jquery/plugins/livestamp/time",["jira/util/formatter","jquery","jira/moment","jira/util/data/meta"],function(e,t,n,o){"use strict";function r(e,t){this.key=e,this.isAge=t}function a(t,n,o){return t in I?e.format(I[t],o):null}function i(e){switch(e.key){case"short":case"shortAge":return"ll";case"long":case"longAge":return"LL";case"full":case"fullAge":case"timestamp":return"LLL";default:return null}}function u(e){return e.clone().hours(0).minutes(0).seconds(0).milliseconds(0)}function l(e,t){var n=u(e);return n.clone().subtract("d",1)<=t&&t<n}function m(e,t){var n=u(e).add("d",1),o=n.clone().add("d",1);return n<=t&&t<o}function s(e,t){return Math.floor(t.diff(e,"minutes",!0))}function c(e,t){var n=t.diff(e,"hours",!0);return Math.round(n)}function d(e,t){return Math.floor(t.diff(e,"days",!0))}function g(e,t){var n=i(t);return e.format(n)}function f(e,t,o){if(o=o||n(),e<=o){if(e>o.clone().subtract("m",1))return a("aMomentAgo",t);if(e>o.clone().subtract("m",2))return a("oneMinuteAgo",t);if(e>o.clone().subtract("m",50))return a("xMinutesAgo",t,s(e,o));if(e>o.clone().subtract("m",90))return a("oneHourAgo",t);if(l(o,e)&&e<o.clone().subtract("h",5))return a("oneDayAgo",t);if(e>o.clone().subtract("d",1))return a("xHoursAgo",t,c(e,o));if(e>o.clone().subtract("d",7))return a("xDaysAgo",t,Math.max(d(e,o),2));if(e>o.clone().subtract("d",8))return a("oneWeekAgo",t)}else{if(e<o.clone().add("m",1))return a("inAMoment",t);if(e<o.clone().add("m",2))return a("inOneMinute",t);if(e<o.clone().add("m",50))return a("inXMinutes",t,s(o,e));if(e<o.clone().add("m",90))return a("inOneHour",t);if(m(o,e)&&e>o.clone().add("h",5))return a("inOneDay",t);if(e<o.clone().add("d",1))return a("inXHours",t,c(o,e));if(e<o.clone().add("d",7))return a("inXDays",t,Math.max(d(o,e),2));if(e<o.clone().add("d",8))return a("inOneWeek",t)}return g(e,t)}var v={},x=o.getBoolean("date-relativize");r.types={};for(var A,h=["shortAge","longAge","fullAge","short","long","full","timestamp"],T=0,y=h.length;T<y;T++)A=h[T],r.types[A]=new r(A,-1!==A.toLowerCase().indexOf("age"));var I={};return v.FormatType=r,v.formatDate=function(e,t,n){return e&&t?(x||n)&&t.isAge?f(e,t):g(e,t):null},v.setRelativeTranslations=function(e){for(var t in e)I[t]=e[t]},v.restoreDefaultRelativeTranslations=function(){this.setRelativeTranslations({inAMoment:e.I18n.getText("common.date.relative.in.a.moment"),inOneMinute:e.I18n.getText("common.date.relative.in.one.minute"),inXMinutes:e.I18n.getText("common.date.relative.in.x.minutes"),inOneHour:e.I18n.getText("common.date.relative.in.one.hour"),inXHours:e.I18n.getText("common.date.relative.in.x.hours"),inOneDay:e.I18n.getText("common.date.relative.in.one.day"),inXDays:e.I18n.getText("common.date.relative.in.x.days"),inOneWeek:e.I18n.getText("common.date.relative.in.one.week"),aMomentAgo:e.I18n.getText("common.date.relative.a.moment.ago"),oneMinuteAgo:e.I18n.getText("common.date.relative.one.minute.ago"),xMinutesAgo:e.I18n.getText("common.date.relative.x.minutes.ago"),oneHourAgo:e.I18n.getText("common.date.relative.one.hour.ago"),xHoursAgo:e.I18n.getText("common.date.relative.x.hours.ago"),oneDayAgo:e.I18n.getText("common.date.relative.one.day.ago"),xDaysAgo:e.I18n.getText("common.date.relative.x.days.ago"),oneWeekAgo:e.I18n.getText("common.date.relative.one.week.ago")})},v.restoreDefaultRelativeTranslations(),v.formatDateWithRelativeAge=f,v.formatDateWithFormatString=g,v}),AJS.namespace("JIRA.Time",null,require("jira/jquery/plugins/livestamp/time"));