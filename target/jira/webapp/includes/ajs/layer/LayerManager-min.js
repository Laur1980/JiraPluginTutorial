!function(){"use strict";function e(e,r){return"string"==typeof r&&(r=[r]),s.any(r,function(r){return a.contains(e,r)})}function r(){return l(window)}function n(e){return(e.$layer||e.$popup||e.$||e.popup||e.element||e)[0]}function t(t){t.bind("showLayer",function(n,t,i){if(!e(i&&i.id,["user-hover-dialog","aui-inline-edit-error","watchers","jira-help-tip"])){var u=r().AJS;u.currentLayerItem&&i!==u.currentLayerItem&&"popup"!==u.currentLayerItem.type&&u.currentLayerItem.hide(),i&&(u.currentLayerItem=i,u.currentLayerItem.type=t)}}).bind("hideLayer",function(t,i,u){if(u&&!e(u.id,["user-hover-dialog","aui-inline-edit-error","jira-help-tip"])){var a=r().AJS;a.currentLayerItem&&(a.currentLayerItem===u?a.currentLayerItem=null:d.contains(n(u),n(a.currentLayerItem))&&a.currentLayerItem.hide())}}).bind("hideAllLayers",function(){var e=r().AJS;e.currentLayerItem&&e.currentLayerItem.hide()}).click(function(e){var n=r().AJS,t=n.currentLayerItem;!t||"popup"===t.type||"inlineDialog"===t.type&&t.persistent||(t._validateClickToClose?t._validateClickToClose(e)&&(t instanceof AJS.InlineLayer?t.hide(o.clickOutside,e):t.hide()):t.hide())})}var i=require("jira/util/events"),u=require("jira/util/events/types"),a=require("jira/util/strings"),o=require("jira/ajs/layer/hide-reasons"),c=require("jira/ajs/layer/layer-interactions"),l=require("jira/util/top-same-origin-window"),d=require("jquery"),s=require("underscore"),p=d(document);i.bind("Dialog.beforeHide",function(e){s.any(c.preventDialogHide(),function(e){return e&&e.current})&&e.preventDefault()}),i.bind("Dialog.show",function(e){s.each(c.hideBeforeDialogShown(),function(r){r&&r.current&&(r.current.hide(),e.preventDefault())})}),p.bind("beforeBlurInput",function(e){s.any(c.preventInputBlur(),function(e){return e&&e.current})&&e.preventDefault()}),u.BEFORE_INLINE_EDIT_CANCEL&&i.bind(u.BEFORE_INLINE_EDIT_CANCEL,function(e,r,n,t){if(t===JIRA.Issues.CANCEL_REASON.escPressed){s.any(c.preventInlineEditCancel(),function(e){return e&&e.current})&&e.preventDefault()}}),p.bind("iframeAppended",function(e,r){r=d(r),r.load(function(){t(r.contents())})}),t(p)}();