AJS.test.require(["jira.webresources:default-comment-security-level"],function(){"use strict";var e=require("jira/ajs/select/security/default-comment-security-level-model");module("DefaultCommentSecurityLevelModel"),test("check if _isLvlObjValid() correctly validates LvlObj",function(){var l=new e("9001");ok(l._isLvlObjValid({level:"this is valid level value",levelName:"this is valid level name"}),"object with level and levelName fields should be valid"),ok(!l._isLvlObjValid({error:"this is not valid LvlObj"}),"object with error field should not be valid"),ok(!l._isLvlObjValid({level:"it has level field",emaNlevel:"but has no level name"}),"object with lvl field and one other field should not be valid"),ok(!l._isLvlObjValid({levelName:"it has level name"}),"object with only levelName should not be valid")}),test("check if updateDefault() executes onSuccess callback when ajax request is successful",function(){var l=new e("9001");l._sendDefaultChangedAnalytics=function(){},l._getDefaultStoreRequest=function(){var e={done:function(l){return l(),e},fail:function(){return e}};return e};var t=this.sandbox.spy(),a=this.sandbox.spy();l.updateDefault({level:"foo",levelName:"bar"},t,a),sinon.assert.calledOnce(t,"success callback should be called once"),sinon.assert.notCalled(a,"error callback should not be called"),equal(l._currentDefault.level,"foo","_currentDefault should be set to level: 'foo' and levelName: 'bar'")}),test("check if updateDefault() executes onError callback when ajax request fails",function(){var l=new e("9001");l._sendDefaultChangedAnalytics=function(){},l._getDefaultStoreRequest=function(){var e={done:function(){return e},fail:function(l){return l("xhr placeholder"),e}};return e};var t=this.sandbox.spy(),a=this.sandbox.spy();l.updateDefault({level:"foo",levelName:"bar"},t,a),sinon.assert.calledOnce(a,"error callback should be called once"),sinon.assert.calledWith(a,"xhr placeholder"),sinon.assert.notCalled(t,"success callback should not be called"),equal(l._currentDefault,null,"_currentDefault should be set to null")}),test("check if getDefault() executes onSuccess callback when ajax request is successful",function(){var l=new e("9001");l._isLvlObjValid=function(){return!0},l._getDefaultLoadRequest=function(){var e={done:function(l){return l("level as a string"),e},fail:function(){return e}};return e};var t=this.sandbox.spy();l.getDefault(t,null),sinon.assert.calledOnce(t,"callback should be called once"),sinon.assert.calledWith(t,"level as a string"),equal(l._currentDefault,"level as a string","_currentDefault should be set to 'level as a string'")}),test("check if getDefault() executes onError callback when ajax request fails",function(){var l=new e("9001");l._getDefaultLoadRequest=function(){var e={done:function(){return e},fail:function(l){return l("oh crap"),e}};return e};var t=this.sandbox.spy();l.getDefault(null,t),sinon.assert.calledOnce(t,"callback should be called once"),sinon.assert.calledWith(t,"oh crap"),equal(l._currentDefault,null,"_currentDefault should be set to null")})});