AJS.test.require(["jira.webresources:jira-global","jira.webresources:select-pickers","com.atlassian.auiplugin:ajs-underscorejs","jira.webresources:issue-statuses"],function(){"use strict";var t=require("jquery"),e=require("underscore"),o=require("jira/ajs/select/checkbox-multi-select-status-lozenge");module("CheckboxMultiSelectStatusLozenge",{setup:function(){function s(e){return e?t("#searcher-status-suggestions").find(e).find("li.check-list-item"):t("#searcher-status-suggestions li.check-list-item")}function u(t,e){return s(e).filter(":contains("+t+")")}this.sandbox=sinon.sandbox.create(),this.sandbox.stub(t.fn,"tipsy");var i=t('<select class="select js-default-checkboxmultiselectstatuslozenge" data-placeholder-text="Find Statuses..." id="searcher-status" multiple="multiple" name="status" size="4" data-status-lozenge="true"><option class="imagebacked" data-icon="/jira/images/icons/statuses/open.png" value="1" title="Open" data-simple-status="{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;Open&quot;,&quot;description&quot;:&quot;The issue is open and ready for the assignee to start work on it.&quot;,&quot;iconUrl&quot;:&quot;/jira/images/icons/statuses/open.png&quot;,&quot;statusCategory&quot;:{&quot;id&quot;:2,&quot;key&quot;:&quot;new&quot;,&quot;colorName&quot;:&quot;blue-gray&quot;}}">Open</option><option class="imagebacked" data-icon="/jira/images/icons/statuses/inprogress.png" value="3" title="In Progress" data-simple-status="{&quot;id&quot;:&quot;3&quot;,&quot;name&quot;:&quot;In Progress&quot;,&quot;description&quot;:&quot;This issue is being actively worked on at the moment by the assignee.&quot;,&quot;iconUrl&quot;:&quot;/jira/images/icons/statuses/inprogress.png&quot;,&quot;statusCategory&quot;:{&quot;id&quot;:4,&quot;key&quot;:&quot;indeterminate&quot;,&quot;colorName&quot;:&quot;yellow&quot;}}">In Progress</option><option class="imagebacked" data-icon="/jira/images/icons/statuses/reopened.png" value="4" title="Reopened" data-simple-status="{&quot;id&quot;:&quot;4&quot;,&quot;name&quot;:&quot;Reopened&quot;,&quot;description&quot;:&quot;This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.&quot;,&quot;iconUrl&quot;:&quot;/jira/images/icons/statuses/reopened.png&quot;,&quot;statusCategory&quot;:{&quot;id&quot;:4,&quot;key&quot;:&quot;indeterminate&quot;,&quot;colorName&quot;:&quot;yellow&quot;}}">Reopened</option><option class="imagebacked" data-icon="/jira/images/icons/statuses/resolved.png" value="5" title="Resolved" data-simple-status="{&quot;id&quot;:&quot;5&quot;,&quot;name&quot;:&quot;Resolved&quot;,&quot;description&quot;:&quot;A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.&quot;,&quot;iconUrl&quot;:&quot;/jira/images/icons/statuses/resolved.png&quot;,&quot;statusCategory&quot;:{&quot;id&quot;:3,&quot;key&quot;:&quot;done&quot;,&quot;colorName&quot;:&quot;green&quot;}}">Resolved</option><option class="imagebacked" data-icon="/jira/images/icons/statuses/closed.png" value="6" title="Closed" data-simple-status="{&quot;id&quot;:&quot;6&quot;,&quot;name&quot;:&quot;Closed&quot;,&quot;description&quot;:&quot;The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.&quot;,&quot;iconUrl&quot;:&quot;/jira/images/icons/statuses/closed.png&quot;,&quot;statusCategory&quot;:{&quot;id&quot;:3,&quot;key&quot;:&quot;done&quot;,&quot;colorName&quot;:&quot;green&quot;}}">Closed</option><option class="imagebacked" data-icon="/jira/images/icons/statuses/otherstatus.png" value="7" title="Other Status">Other Status</option></select>').appendTo("#qunit-fixture"),n=new o({element:i,stallEventBind:!1});this.tester={type:function(t){return n.$field.focus().val(t).trigger("input"),this}},this.assert={suggestions:function(){equal(s().length,arguments.length,"Expected "+arguments.length+" suggestions present"),e.each(arguments,function(t){ok(1===u(t).length,'Expected suggestion "'+t+'" to be present')})},allSuggestions:function(){this.suggestions("Open","In Progress","Reopened","Resolved","Closed","Other Status")},lozengesNumber:function(t){var e=s().find(".aui-lozenge");equal(e.length,t,"Expected "+t+" lozenges to be present")},nonLozengesItemsNumber:function(t){var e=s().find("input[type=checkbox] ~ :not(.aui-lozenge)");equal(e.length,t,"Expected "+t+" non-lozenge items to be present")}}},teardown:function(){t("#searcher-status-multi-select").remove(),t("#searcher-status").remove(),this.sandbox.restore()}}),test("correct init state",function(){this.assert.allSuggestions(),this.assert.lozengesNumber(5),this.assert.nonLozengesItemsNumber(1)}),test("basic querying",function(){this.tester.type("O"),this.assert.suggestions("Open","Other Status")})});