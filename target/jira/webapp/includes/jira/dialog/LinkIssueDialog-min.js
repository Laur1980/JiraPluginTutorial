define("jira/dialog/link-issue-dialog-factory",["require"],function(e){"use strict";function i(e,i){var n=!1;return p.each(i,function(i,t){if(t.id===e)return t.isSelected=!0,n=!0,!1}),n||(i[0].isSelected=!0),i}function n(e){var i=new m;return d.makeRequest({url:h+"/rest/viewIssue/1/remoteIssueLink/linkType?issueId="+e,complete:function(e,n,t){t.successful?i.resolve(t.data):i.reject(d.buildDialogErrorContent(t))}}),i.promise()}function t(e){var i=new m,n=c.getDefaultAjaxOptions.call(e);return n.complete=function(e,n,t){t.successful?i.resolve(t.data):i.reject(d.buildDialogErrorContent(t))},d.makeRequest(n),i.promise()}function s(e){return e.$activeTrigger.attr("id")}function r(){return k(["wrc!com.atlassian.jira.jira-issue-link-web-plugin:init-issuelink-web","wrc!com.atlassian.jira.jira-issue-link-confluence-plugin:init-issuelink-confluence","wrc!com.atlassian.jira.jira-issue-link-remote-jira-plugin:init-issuelink-jira"])}function a(e){return new l({id:"link-issue-dialog",isIssueDialog:!0,trigger:e,onSuccessfulSubmit:function(e,i){"warning"!==i.getResponseHeader("X-Atlassian-Dialog-Msg-Type")&&c.storeCurrentIssueIdOnSucessfulSubmit.apply(this,arguments)},issueMsg:"thanks_issue_linked",widthClass:"large",stacked:!0,content:function(e){var a=this,o=g.getIssueId()||f.getSelectedIssueId(),u=r(),l=n(o),c=t(a);p.when(c,l,u).done(function(n,t){t=i(s(a),t),e(JIRA.Templates.LinkIssue.dialog({linkTypes:t,tabContent:n})),p.each(t,function(e,i){var n;!0===i.isSelected&&(n="[name='"+i.focusedFieldName+"']",0===p(n).length&&(n="#"+i.id),a._focusFirstField(n))})}).fail(function(i,n){e(n||i)})},formatSubmitResponseContent:function(e){return this.get$popupContent().find(".dialog-pane").html(e),this.get$popupContent().html()},onContentRefresh:function(){this.bindAnchorsToDialog(this.get$popupContent().find(".dialog-menu-item "))}})}var o=e("jira/deprecator"),u=e("jira/dialog/dialog-factory"),l=e("jira/dialog/form-dialog"),c=e("jira/dialog/dialog-util"),d=e("jira/ajs/ajax/smart-ajax"),g=e("jira/issue"),f=e("jira/issuenavigator/issue-navigator"),p=e("jquery"),m=e("jira/jquery/deferred"),j=e("wrm/context-path"),k=e("wrm/require"),h=j();return u.createLinkIssueDialog=a,o.prop(u,"createLinkIssueDialog",{sinceVersion:"7.3",removeInVersion:"8.0"}),{createLinkIssueDialog:a}});