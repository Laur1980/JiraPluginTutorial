define("jira/dialog/labels-dialog",["jira/dialog/form-dialog","jira/issue","jira/issuenavigator/issue-navigator","jira/util/events","jira/util/events/types","wrm/context-path","jquery"],function(i,t,e,s,n,o,l){"use strict";var a=o();return i.extend({init:function(i){this._super(i),this.issueId=null,this.customFieldId=null,this.labelsProvider=this.initLabelsProvider(),this.labelPicker=null},initLabelsProvider:function(){return this.options.labelsProvider&&l.isFunction(this.options.labelsProvider)?this.options.labelsProvider:this.options.labels?this._getLabelsFromOptions:this._getLabelsFromTrigger},_getLabelsFromOptions:function(){return l(this.options.labels)},_getLabelsFromTrigger:function(){return this.$activeTrigger.closest(".labels-wrap")},decorateContent:function(){this._super();var i=this.get$popupContent();this.issueId=i.find("input[name=id]").val();var t=i.find("input[name=customFieldId]");1===t.length?this.customFieldId=t.val():this.customFieldId=null},focusLabelPicker:function(){this.get$popupContent().find("textarea").focus()},show:function(){this._super()&&this.focusLabelPicker()},_handleSubmitResponse:function(i,o,r){if(this.serverIsDone){this.options.onSuccessfulSubmit&&this.options.onSuccessfulSubmit.call(this,i,o,r);var u=this.get$popupContent().find("input[name=id]").val(),d=this.get$popupContent().find("input[name=noLink]").val();this.options.autoClose&&this.hide();var h={id:u,decorator:"none",noLink:d};this.customFieldId&&(h.customFieldId=this.customFieldId);var c=this,p=c.labelsProvider(this);l(l.ajax({url:a+"/secure/EditLabels!viewLinks.jspa",data:h,success:function(i){var o=l("<div>").html(i).find(".labels-wrap");e.isNavigator()&&o.find("a.edit-labels").remove(),p.html(o.html()),n.REFRESH_ISSUE_PAGE&&s.trigger(n.REFRESH_ISSUE_PAGE,[t.getIssueId()])}})).throbber({target:p})}},handleCancel:function(){this._super(),this.$content=null}})}),AJS.namespace("AJS.LabelsPopup",null,require("jira/dialog/labels-dialog")),AJS.namespace("JIRA.LabelsDialog",null,require("jira/dialog/labels-dialog"));