define("jira/versionblocks/version-blocks",["jquery"],function(e){"use strict";var n={ClassNames:{VERSION_LIST:"versions-list",VERSION_CONTAINER:"version-block-container",EXPANDED_CONTENT_CONTAINER:"version-issue-table"},init:function(){function o(n){var o={decorator:"none",contentOnly:!0,noTitle:!0,selectedTab:a(),pid:t.data("project-id"),component:t.data("component-id")};return e.extend(o,n)}function a(){var e=t.data("selected-tab"),n=""+window.document.location.search+window.document.location.hash;return n.indexOf("selectedTab=")>-1&&(e=n.replace(/^.*selectedTab=(.*?)(?:&.*$|$)/,"$1"),e=decodeURIComponent(e)),e}var i=n.ClassNames,t=e("."+i.VERSION_LIST).first(),s=function(){var e;return e=window.document.location.href,e=e.replace(window.document.location.hash,""),e=e.replace(window.document.location.search,"")}();e(document).on("click","a[data-version-block]",function(n){var a=e(this),t=a.closest("."+i.VERSION_CONTAINER),d=t.data("expanded"),r=t.find("."+i.EXPANDED_CONTENT_CONTAINER),c=e("<span class='icon loading'></span>");r.size()||(r=e("<div/>").addClass(i.EXPANDED_CONTENT_CONTAINER).hide().appendTo(t));var l={};l[d?"collapseVersion":"expandVersion"]=t.find("[data-version-id]").data("version-id");var u=e.ajax({url:s,data:o(l),dataType:"json",beforeSend:function(){a.closest("ul").append(e("<li/>").append(c))}});u.always(function(){c.parent("li").remove()}),u.fail(function(e,n,o){console.log("Failed to load issues for version. User-facing error to do, sorry :(",arguments)}),d?u.done(function(){r.hide()}):u.done(function(n,o,a){var t=e("<div/>").html(n.content),s=t.find("."+i.EXPANDED_CONTENT_CONTAINER);r.hide().replaceWith(s).show()}),u.done(function(){t.data("expanded",!d)}),n.preventDefault()})}};return n}),AJS.namespace("JIRA.VersionBlocks",null,require("jira/versionblocks/version-blocks"));